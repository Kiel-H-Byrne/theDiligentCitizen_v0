{"metadata":{"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}},"usedHelpers":[]},"ignored":false,"code":"console.log(\"--legiScan.js\");\n\n/*\nparams\nstate     State abbreviation to search on, or ALL for entire nation\nbill      Bill number for an exact bill number or to limit query\nquery     Full text query string to run against the search engine, URL encoded\nyear      Year where 1=all, 2=current, 3=recent, 4=prior, >1900=exact [Default: 2]\npage      Result set page number to return [Default: 1]\n\n*/\n\n/*\n * Used as a comparison function to sort the array of bills that come back from a legiscan query.\n * This will sort that array based on the last action date descending.\n */\n\nfunction compareActionDates(documentA, documentB) {\n  /* excepting the query from borking up the results ordering */\n  if (documentA.name === \"query\") {\n    return 1;\n  } else if (documentB.name === \"query\") {\n    return -1;\n  }\n\n  /* extracting dates from the legiscan result objects\n   * ex: {\n   *       bill_id: 847164\n   *       bill_number: \"HB1264\"\n   *       change_hash: \"372c1fac92a0b989862f062d5ae81b2a\"\n   *       last_action: \"Hearing 3/15 at 1:00 p.m.\"\n   *       last_action_date: \"2016-03-15\"\n   *       relevance: 95\n   *       research_url: \"https://legiscan.com/MD/research/HB1264/2016\"\n   *       state: \"MD\"\n   *       text_url: \"https://legiscan.com/MD/text/HB1264/2016\"\n   *       title: \"Criminal Procedure - Right of Appeal - Unlawful Possession of Firearm\"\n   *       url: \"https://legiscan.com/MD/bill/HB1264/2016\"\n   *   }\n   */\n  var last_action_dateA = new Date(documentA.value.last_action_date);\n  var last_action_dateB = new Date(documentB.value.last_action_date);\n\n  //console.log(\"Testing: \"+ last_action_dateA +\" vs \" + last_action_dateB);\n\n  /*\n   *  Checking for undefined dates\n   */\n  if (!last_action_dateA && last_action_dateB) {\n    return -1;\n  }\n  if (!last_action_dateB && last_action_dateA) {\n    return 1;\n  }\n\n  /*\n   * Actual date logic\n   */\n  if (last_action_dateA < last_action_dateB) {\n    return 1;\n  } else if (last_action_dateA > last_action_dateB) {\n    return -1;\n  } else {\n    return 0;\n  }\n}\n\n//function creates object of words and their frequencies.\n// obj = object to pluck\n// key = key name to pluck\n// i.e\nfunction getFreq(obj) {\n\n  var wordsArr = _.pluck(obj, 'title').join(\" \");\n  //  console.log(wordsArr);\n  var wordCount = wordsArr.length;\n\n  /* Below is a regular expression that finds alphanumeric characters\n     Next is a string that could easily be replaced with a reference to a form control\n     Lastly, we have an array that will hold any words matching our pattern */\n  var pattern = /\\w+/g,\n      matchedWords = wordsArr.match(pattern);\n\n  /* The Array.prototype.reduce method assists us in producing a single value from an\n     array. In this case, we're going to use it to output an object with results. */\n  var freqObj = matchedWords.reduce(function (stats, word) {\n\n    /* `stats` is the object that we'll be building up over time.\n       `word` is each individual entry in the `matchedWords` array */\n    if (stats.hasOwnProperty(word)) {\n      /* `stats` already has an entry for the current `word`.\n         As a result, let's increment the count for that `word`. */\n      stats[word] = stats[word] + 1;\n    } else {\n      /* `stats` does not yet have an entry for the current `word`.\n         As a result, let's add a new entry, and set count to 1. */\n      stats[word] = 1;\n    }\n\n    /* Because we are building up `stats` over numerous iterations,\n       we need to return it for the next pass to modify it. */\n    return stats;\n  }, {});\n\n  /* Now that `freqObj` has our object, we can log it. */\n  //console.log( freqObj );\n\n  //return freqObj;\n\n  var keys = _.keys(freqObj);\n  var values = _.map(keys, function (k) {\n    return freqObj[k];\n  });\n  // Transpose the values matrix\n\n  var cloudArr = _.zip(keys, values);\n\n  return cloudArr;\n};\n\nmakeCloud = function (arr) {\n  var element = $('#wcloud')[0];\n\n  var options = {\n    list: arr,\n    gridSize: Math.round(10 * $('#wcloud').width() / 1024),\n    weightFactor: function (size) {\n      size = size * 5;\n      return Math.pow(size, 1.3) * $('#wcloud').width() / 1024;\n    },\n    fontFamily: 'Garamond, serif',\n    color: 'random-dark',\n    classes: 'cloudWords',\n    rotateRatio: 0.5\n    //shape : 'square'\n  };\n  console.log(arr);\n  WordCloud(element, options);\n};\n\nvar getList = function () {\n  listDep.depend();\n  return list;\n};\n\nvar setList = function (l) {\n  list = l;\n  listDep.changed();\n};\n\n/*  */\n\nTemplate.legiScanSearch.helpers({\n  location: function () {\n    var ipInfo = Session.get('ipInfo');\n    if (ipInfo) {\n      var state;\n      state = ipInfo.state;\n      ipInfo.region = abbr_State(state, \"name\");\n      return ipInfo.region;\n    }\n  }\n});\n\nTemplate.legiScanSearch.events({\n  'submit #legi-search': function (evt, tpl) {\n    event.preventDefault();\n\n    var query = tpl.find('input#query').value;\n\n    Session.set('query', query);\n\n    /*\n        var state = Session.get('ipInfo').state;\n    \n        if (Session.get('newState')) {\n          state = Session.get('newState');\n        }\n    \n        var params = {};\n          params.query = tpl.find('input#query').value;\n          params.year = 2016;\n          params.state = state;\n        \n        Session.set('query', params.query);\n    \n        var op = 'search';\n        var urlParams = jQuery.param(params);\n    \n        Meteor.call('legiScan', op, urlParams, function (err, res) {\n          // The method call sets the Session variable to the callback value\n          if (err) { \n            Session.set('results', {error: err});\n          } else {\n            res = res.searchresult;\n            res.query = params.query;\n            Session.set('results', res);\n            Session.set('list', getFreq(res));\n            //makeCloud(zipObj(getFreq(res)));\n            return res;\n          }\n        });\n    */\n    analytics.track(\"Legi Search\", {\n      query: query\n    });\n  }\n});\n\nTemplate.legiScanResults.helpers({\n  results: function () {},\n  query: function () {\n    query = Session.get('query');\n    //console.log(query);\n    return query;\n  },\n  queryList: function () {\n\n    var state = Session.get('ipInfo').state;\n\n    if (Session.get('newState')) {\n      state = Session.get('newState');\n    }\n\n    var params = {};\n    params.query = Session.get('query');\n    params.year = 2016;\n    params.state = state;\n\n    Session.set('query', params.query);\n\n    var op = 'search';\n    var urlParams = jQuery.param(params);\n\n    Meteor.call('legiScan', op, urlParams, function (err, res) {\n      // The method call sets the Session variable to the callback value\n      if (err) {\n        return err;\n      } else {\n        res = res.searchresult;\n        res.query = params.query;\n        Session.set('results', res);\n        Session.set('list', getFreq(res));\n        //makeCloud(zipObj(getFreq(res)));\n        //return res;\n      }\n    });\n\n    queryArr = [];\n    var obj = Session.get('results');\n    for (var key in babelHelpers.sanitizeForInObject(obj)) {\n      queryArr.push({\n        name: key,\n        value: obj[key]\n      });\n    }\n\n    queryArr.sort(compareActionDates);\n\n    //console.log(queryArr);\n    return queryArr;\n  }\n});","ast":null,"map":{"version":3,"sources":["/client/js/legiScan.js"],"names":[],"mappings":"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","file":"/client/js/legiScan.js.map","sourcesContent":["console.log(\"--legiScan.js\");\n\n\n/*\nparams\nstate     State abbreviation to search on, or ALL for entire nation\nbill      Bill number for an exact bill number or to limit query\nquery     Full text query string to run against the search engine, URL encoded\nyear      Year where 1=all, 2=current, 3=recent, 4=prior, >1900=exact [Default: 2]\npage      Result set page number to return [Default: 1]\n\n*/\n\n/*\n * Used as a comparison function to sort the array of bills that come back from a legiscan query.\n * This will sort that array based on the last action date descending.\n */\n\n\n\nfunction compareActionDates(documentA, documentB) {\n  /* excepting the query from borking up the results ordering */\n  if(documentA.name === \"query\") {\n    return 1;\n  } else if(documentB.name === \"query\") {\n    return -1;\n  }\n\n  /* extracting dates from the legiscan result objects\n   * ex: {\n   *       bill_id: 847164\n   *       bill_number: \"HB1264\"\n   *       change_hash: \"372c1fac92a0b989862f062d5ae81b2a\"\n   *       last_action: \"Hearing 3/15 at 1:00 p.m.\"\n   *       last_action_date: \"2016-03-15\"\n   *       relevance: 95\n   *       research_url: \"https://legiscan.com/MD/research/HB1264/2016\"\n   *       state: \"MD\"\n   *       text_url: \"https://legiscan.com/MD/text/HB1264/2016\"\n   *       title: \"Criminal Procedure - Right of Appeal - Unlawful Possession of Firearm\"\n   *       url: \"https://legiscan.com/MD/bill/HB1264/2016\"\n   *   }\n   */\n  var last_action_dateA = new Date(documentA.value.last_action_date);\n  var last_action_dateB = new Date(documentB.value.last_action_date);\n\n  //console.log(\"Testing: \"+ last_action_dateA +\" vs \" + last_action_dateB);\n\n  /*\n   *  Checking for undefined dates\n   */\n  if(!last_action_dateA && last_action_dateB) {\n    return -1;\n  }\n  if(!last_action_dateB && last_action_dateA) {\n    return 1;\n  }\n\n  /*\n   * Actual date logic\n   */\n  if(last_action_dateA < last_action_dateB) {\n    return 1;\n  } else if(last_action_dateA > last_action_dateB) {\n    return -1;\n  } else {\n    return 0;\n  }\n}\n\n//function creates object of words and their frequencies. \n// obj = object to pluck \n// key = key name to pluck\n// i.e \nfunction getFreq(obj) {\n\n  var wordsArr = _.pluck(obj, 'title').join(\" \");\n//  console.log(wordsArr);\n  var wordCount = wordsArr.length;\n\n  /* Below is a regular expression that finds alphanumeric characters\n     Next is a string that could easily be replaced with a reference to a form control\n     Lastly, we have an array that will hold any words matching our pattern */\n  var pattern = /\\w+/g,\n      matchedWords = wordsArr.match( pattern );\n\n  /* The Array.prototype.reduce method assists us in producing a single value from an\n     array. In this case, we're going to use it to output an object with results. */\n  var freqObj = matchedWords.reduce(function ( stats, word ) {\n\n      /* `stats` is the object that we'll be building up over time.\n         `word` is each individual entry in the `matchedWords` array */\n      if ( stats.hasOwnProperty( word ) ) {\n          /* `stats` already has an entry for the current `word`.\n             As a result, let's increment the count for that `word`. */\n          stats[ word ] = stats[ word ] + 1;\n      } else {\n          /* `stats` does not yet have an entry for the current `word`.\n             As a result, let's add a new entry, and set count to 1. */\n          stats[ word ] = 1;\n      }\n\n      /* Because we are building up `stats` over numerous iterations,\n         we need to return it for the next pass to modify it. */\n      return stats;\n\n    }, {} );\n\n    /* Now that `freqObj` has our object, we can log it. */\n    //console.log( freqObj );\n\n    //return freqObj;\n\n    var keys = _.keys(freqObj);\n    var values = _.map(keys, function(k) { return freqObj[k]; });\n    // Transpose the values matrix\n    \n    var cloudArr = _.zip(keys,values);\n    \n    return cloudArr;\n};\n\nmakeCloud = function(arr) {\n  var element = $('#wcloud')[0];\n\n  var options = {\n    list : arr,\n    gridSize : Math.round(10 * $('#wcloud').width() / 1024),\n    weightFactor : function (size) {\n      size = size*5;\n      return Math.pow(size, 1.3) * $('#wcloud').width() / 1024;\n    },\n    fontFamily : 'Garamond, serif',\n    color : 'random-dark',\n    classes : 'cloudWords',\n    rotateRatio : 0.5\n    //shape : 'square'\n    };\n  console.log(arr);\n  WordCloud(element, options);\n\n};\n\n\n\n\nvar getList = function() {\n  listDep.depend();\n  return list;\n};\n\nvar setList = function(l) {\n  list = l;\n  listDep.changed();\n};\n\n\n\n/*  */\n\n\n\nTemplate.legiScanSearch.helpers({\n  location: function() {\n    var ipInfo = Session.get('ipInfo');\n    if (ipInfo) {\n      var state;\n      state = ipInfo.state;\n      ipInfo.region = abbr_State(state, \"name\");\n      return ipInfo.region;\n    }\n  }\n});\n\n\nTemplate.legiScanSearch.events({\n  'submit #legi-search': function (evt, tpl) {\n    event.preventDefault();\n    \n    var query = tpl.find('input#query').value;\n\n    Session.set('query', query);\n\n/*\n    var state = Session.get('ipInfo').state;\n\n    if (Session.get('newState')) {\n      state = Session.get('newState');\n    }\n\n    var params = {};\n      params.query = tpl.find('input#query').value;\n      params.year = 2016;\n      params.state = state;\n    \n    Session.set('query', params.query);\n\n    var op = 'search';\n    var urlParams = jQuery.param(params);\n\n    Meteor.call('legiScan', op, urlParams, function (err, res) {\n      // The method call sets the Session variable to the callback value\n      if (err) { \n        Session.set('results', {error: err});\n      } else {\n        res = res.searchresult;\n        res.query = params.query;\n        Session.set('results', res);\n        Session.set('list', getFreq(res));\n        //makeCloud(zipObj(getFreq(res)));\n        return res;\n      }\n    });\n*/\n    analytics.track(\"Legi Search\", {\n      query: query\n    });\n\n  }\n});\n\n\nTemplate.legiScanResults.helpers({\n  results: function() {\n  \n  },\n  query: function () {\n    query = Session.get('query');\n    //console.log(query);\n    return query;\n  },\n  queryList: function() {\n\n    var state = Session.get('ipInfo').state;\n\n    if (Session.get('newState')) {\n      state = Session.get('newState');\n    }\n\n    var params = {};\n      params.query = Session.get('query');\n      params.year = 2016;\n      params.state = state;\n  \n    Session.set('query', params.query);\n\n    var op = 'search';\n    var urlParams = jQuery.param(params);\n\n    Meteor.call('legiScan', op, urlParams, function (err, res) {\n      // The method call sets the Session variable to the callback value\n      if (err) { \n        return err;\n      } else {\n        res = res.searchresult;\n        res.query = params.query;\n        Session.set('results', res);\n        Session.set('list', getFreq(res));\n        //makeCloud(zipObj(getFreq(res)));\n        //return res;\n      }\n    });\n\n    queryArr = [];\n    var obj = Session.get('results');\n    for (var key in obj) {\n      queryArr.push({\n        name : key,\n        value : obj[key]\n      });\n    }\n\n    queryArr.sort(compareActionDates);\n\n    //console.log(queryArr);\n    return queryArr;\n  }\n});\n\n"]},"hash":"4408e76df0ef26b868806ae9414c70cb695b8ee5"}
