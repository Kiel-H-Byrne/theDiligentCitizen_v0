{"version":3,"sources":["meteor://ðŸ’»app/server/server-methods.js"],"names":[],"mappings":";;;;;;;;AAAA,IAAI,OAAO,GAAG,UAAU,MAAM,EAAE,QAAQ,EAAE;;AAExC,MAAI;AACF,QAAI,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC;;;AAGrC,YAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;GAC1B,CAAC,OAAO,KAAK,EAAE;;AAEd,QAAI,KAAK,CAAC,QAAQ,EAAE;AAClB,UAAI,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC;AACzC,UAAI,YAAY,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC;;KAEhD,MAAM;AACL,YAAI,SAAS,GAAG,GAAG,CAAC;AACpB,YAAI,YAAY,GAAG,wBAAwB,CAAC;OAC7C;;AAED,QAAI,OAAO,GAAG,IAAI,MAAM,CAAC,KAAK,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;AACxD,YAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;GACzB;CACF,CAAC;;AAGF,MAAM,CAAC,OAAO,CAAC;AACb,UAAQ,EAAE,UAAS,MAAM,EAAE,MAAM,EAAE;AACjC,QAAI,CAAC,OAAO,EAAE,CAAC;AACf,WAAO,CAAC,GAAG,CAAG,mCAAmC,GAAE,MAAM,GAAE,UAAU,GAAE,MAAM,CAAC,CAAC;AAC/E,QAAI,GAAG,GAAG,kCAAkC,CAAC;;AAE7C,QAAI,MAAM,GAAG,8CAA8C,GAAG,MAAM,GAAG,UAAU,GAAG,GAAG,GAAG,GAAG,GAAE,MAAM,CAAC;AACtG,QAAI,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC;AACjD,WAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;;AAEpB,WAAO,QAAQ,CAAC;GACjB;AACD,UAAQ,EAAE,UAAS,EAAE,EAAE,KAAK,EAAE;AAC5B,QAAI,CAAC,OAAO,EAAE,CAAC;AACf,WAAO,CAAC,GAAG,CAAG,mCAAmC,GAAE,EAAE,GAAE,UAAU,GAAE,KAAK,CAAC,CAAC;AAC1E,QAAI,GAAG,GAAG,kCAAkC,CAAC;;AAE7C,WAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AACjB,QAAI,MAAM,GAAG,+BAA+B,GAAG,GAAG,GAAG,MAAM,GAAG,EAAE,GAAG,GAAG,GAAG,KAAK,CAAC;AAC/E,QAAI,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC;AACjD,WAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;AACpB,WAAO,QAAQ,CAAC;GACjB;AACD,SAAO,EAAE,UAAS,MAAM,EAAE,MAAM,EAAE;AAChC,QAAI,CAAC,OAAO,EAAE,CAAC;AACf,WAAO,CAAC,GAAG,CAAG,kCAAkC,GAAE,MAAM,GAAE,UAAU,GAAE,MAAM,CAAC,CAAC;AAC9E,QAAI,GAAG,GAAG,0CAA0C,CAAC;;AAErD,QAAI,MAAM,GAAG,sCAAsC,GAAG,GAAG,GAAG,GAAG,GAAE,MAAM,CAAC;AACxE,QAAI,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC;AACjD,WAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;;AAEpB,WAAO,QAAQ,CAAC;GACjB;CACF,CAAC,CAAC","file":"/server/server-methods.js","sourcesContent":["var apiCall = function (apiUrl, callback) {\n  // tryâ€¦catch allows you to handle errors \n  try {\n    var response = HTTP.get(apiUrl).data;\n    // A successful API call returns no error \n    // but the contents from the JSON response\n    callback(null, response);\n  } catch (error) {\n    // If the API responded with an error message and a payload \n    if (error.response) {\n      var errorCode = error.response.data.code;\n      var errorMessage = error.response.data.message;\n    // Otherwise use a generic error message\n    } else {\n      var errorCode = 500;\n      var errorMessage = 'No idea what happened!';\n    }\n    // Create an Error object and return it via callback\n    var myError = new Meteor.Error(errorCode, errorMessage);\n    callback(myError, null);\n  }\n};\n\n\nMeteor.methods({\n  sunLight: function(method, params) {\n    this.unblock();\n    console.log ( '*** running Method.sunLight with '+ method +' param: '+ params);  \n    var key = '345a8f0b36114bde89222326b8b1e1af';\n    //var key = Meteor.settings.public.govSettings.sunlight.apikey;\n    var apiUrl = 'https://congress.api.sunlightfoundation.com/' + method + '?apikey=' + key + '&' +params;\n    var response = Meteor.wrapAsync(apiCall)(apiUrl);  \n    console.log(apiUrl);\n    //console.log(response);\n    return response;\n  },  \n  legiScan: function(op, param) {\n    this.unblock();\n    console.log ( '*** running Method.legiScan with '+ op +' param: '+ param);\n    var key = '5e92d12f203ca365fbdcdad88418e626';\n    //var key = Meteor.settings.public.govSettings.legiscan.key;\n    console.log(key);    \n    var apiUrl = 'http://api.legiscan.com/?key=' + key + '&op=' + op + '&' + param;\n    var response = Meteor.wrapAsync(apiCall)(apiUrl);\n    console.log(apiUrl);\n    return response;\n  },\n  openFEC: function(method, params) {\n    this.unblock();\n    console.log ( '*** running Method.openFEC with '+ method +' param: '+ params);  \n    var key = 'VlzCNbEgjbxSxKTDHgET4DWnZdVuVaOB3SkI2C3I';\n    //var key = Meteor.settings.public.govSettings.openfec.api_key;\n    var apiUrl = 'https://api.open.fec.gov/v1?api_key=' + key + '&' +params;\n    var response = Meteor.wrapAsync(apiCall)(apiUrl);  \n    console.log(apiUrl);\n    //console.log(response);\n    return response;\n  }\n});\n\n/* Methods \n/legislators\n/legislators/locate \n/districts/locate \n/committees \n/bills  \n/bills/search\n/amendments \n/nominations\n/votes  \n/floor_updates\n/hearings \n/upcoming_bills\n/congressional_documents/search\n/documents/search\n\n*/\n"]}